@page "/profile"
@attribute [Authorize]

<PageTitle>@Layout.PageTitle</PageTitle>

<div class="row">
    <div class="col-xl-4 col-md-4 col-12">
        <div class="inner-padding">
            <div class="card-body">
                <div class="col-12 text-center mb-2">
                    <div @onclick="ToggleImageEdit">
                        <Avatar FilePath="@Constants.FilePath.UsersImagesFilePath"
                                ImageUrl="@UserProfile.ImageUrl"
                                Name="@UserProfile.Name"
                                Height="100"
                                Width="100"/>
                    </div>
                </div>
                <div class="row text-center gap-y-1">
                    <MudText Typo="Typo.subtitle2" Class="fw-bold text-dark user-name">@UserProfile.Name</MudText>
                    <MudText Typo="Typo.subtitle2" Class="text-normal user-email">@UserProfile.Email</MudText>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary" Class="fw-bold user-designation">@UserProfile.RoleName</MudText>
                    <MudText Typo="Typo.subtitle2" Align="Align.Center" Color="Color.Secondary">@UserProfile.Organization</MudText>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-8 col-md-8 col-12">
        <MudTabs Elevation="0" PanelClass="bg-white" @bind-ActivePanelIndex="ActivePanelIndex" Class="gap-3">
            <MudTabPanel Text="Personal Detail" Icon="@Icons.Material.Filled.Person" BadgeColor="Color.Secondary">
                @if (ActivePanelIndex == 0)
                {
                    <PersonalDetails OnProfileDetailsUpdate="UpdateProfileDetails" />
                }
            </MudTabPanel>
            <MudTabPanel Text="Change Password" Icon="@Icons.Material.Filled.Password" BadgeColor="Color.Secondary">
                @if (ActivePanelIndex == 1)
                {
                    <ChangePassword />
                }
            </MudTabPanel>
        </MudTabs>
    </div>
</div>

@if (OpenImageDrawerToggle)
{
    <ModalLayout T="@FileUploadResultDto"
                 Module="Upload Image"
                 SubmitColor="Color.Primary"
                 Size="modal-md"
                 OnSave="ToggleImageEdit">
        <ImageCropper OnFileUploaded="HandleValidImageSubmit" />
    </ModalLayout>
}